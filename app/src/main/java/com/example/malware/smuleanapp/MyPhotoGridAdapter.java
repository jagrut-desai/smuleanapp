package com.example.malware.smuleanapp;

import android.app.Activity;
import android.content.Context;
import android.graphics.Bitmap;
import android.util.LruCache;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.BaseAdapter;
import android.widget.TextView;

import com.android.volley.toolbox.ImageLoader;
import com.android.volley.toolbox.NetworkImageView;
import com.android.volley.toolbox.Volley;

import java.util.ArrayList;

/**
 * This is the gridview adapter to showcase photos in gridview.
 */
public class MyPhotoGridAdapter extends ArrayAdapter<String> {
    private Context context;
    ArrayList<String> images;
    ImageLoader imageLoader;

    //initialie context, images, and image loader
    public MyPhotoGridAdapter(Context context, ArrayList<String> images) {
        super(context,0,images);
        this.context = context;
        this.images = images;
        imageLoader = new ImageLoader(Volley.newRequestQueue(context), new ImageLoader.ImageCache() {
            private final LruCache<String, Bitmap> mCache = new LruCache<String, Bitmap>(10);
            public void putBitmap(String url, Bitmap bitmap) {
                mCache.put(url, bitmap);
            }
            public Bitmap getBitmap(String url) {
                return mCache.get(url);
            }
        });
    }

    public int getCount() {
        return images.size();
    }

    public String getItem(int position) {
        return null;
    }

    public long getItemId(int position) {
        return 0;
    }

    //This method return individual elments of the girdview.
    //I have used view holder patterm to proparly recycle and creation of the views.
    public View getView(int position, View convertView, ViewGroup parent) {
        MyPhotoGridAdapter.ViewHolder viewHolder;
        if (convertView == null) {

            LayoutInflater inflater = ((Activity) context).getLayoutInflater();
            convertView = inflater.inflate(R.layout.gridview_item,parent,false);
            viewHolder = new MyPhotoGridAdapter.ViewHolder();
            viewHolder.image = (NetworkImageView) convertView.findViewById(R.id.pinImage);
            convertView.setTag(viewHolder);

        } else {
            viewHolder = (ViewHolder) convertView.getTag();
        }

        String imageUrl = images.get(position);
        viewHolder.image.setImageUrl(imageUrl, imageLoader);
        return convertView;
    }
    //view holder class
    static class ViewHolder
    {
        NetworkImageView image;
    }
}